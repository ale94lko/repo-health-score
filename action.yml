name: 'repo-health-score'
description: 'A repository overall health score from community profile metrics'
author: 'Fidel Alejandro Fernandez Arias'
branding:
  icon: 'check-circle'
  color: 'green'
inputs:
  php-version:
    description: 'Version of PHP'
    required: false
    default: 'latest'
outputs:
  badge:
    description: 'badge generated by repo-health-score'
    value: ${{ steps.generate-bagde.outputs.bagde }}
runs:
  using: 'composite'
  steps:
    - name: Setup PHP
      uses: shivammathur/setup-php@v2
      with:
        php-version: ${{ inputs.php-version }}
        extensions: gd

    - name: Run composer
      uses: nick-zh/composer-php@master
      with:
        action: 'install -oa'

    - name: Test
      shell: bash
      run: apt-get install php8.1.8-gd

    - name: Generate badge
      id: generate-bagde
      shell: bash
      env:
        REPOSITORY: ${{ github.repository }}
      run: |
        php index.php > ./bagde.svg
        echo "::set-output name=bagde::$(bagde.svg)"